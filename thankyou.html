<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Thank You ‚Äì Thrivoy</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #f9fafb;
      margin: 0;
      padding: 0;
      color: #333;
    }
    header {
      background: #073378;
      color: white;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 1.8rem;
    }
    main {
      max-width: 800px;
      margin: 30px auto;
      background: #fff;
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    h2 {
      color: #073378;
      margin-top: 1.5em;
    }
    #thankyouStatus {
      font-size: 1.1rem;
      margin-bottom: 20px;
    }
    #businessInfo, #invoiceInfo {
      margin-bottom: 25px;
    }
    a.button {
      display: inline-block;
      padding: 12px 18px;
      margin-top: 10px;
      background: #073378;
      color: #fff;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.2s;
    }
    a.button:hover {
      background: #05285c;
    }
    .invoice-box img {
      max-width: 200px;
      margin-top: 10px;
    }
    footer {
      text-align: center;
      padding: 20px;
      margin-top: 30px;
      font-size: 0.85rem;
      color: #777;
    }
  </style>
</head>
<body>
  <header>
    <h1>üéâ Thank You for Joining Thrivoy!</h1>
  </header>

  <main>
    <div id="thankyouStatus">‚è≥ Loading your details...</div>

    <section id="businessInfo"></section>
    <section id="invoiceInfo" class="invoice-box"></section>

    <section id="nextSteps">
      <h2>üöÄ Next Steps</h2>
      <ul>
        <li>Your website will be live within 1‚Äì3 minutes.</li>
        <li>Check your email for your welcome pack and login details.</li>
        <li>Complete your payment if you selected a paid plan.</li>
        <li>Start customizing your content and engaging customers.</li>
      </ul>
    </section>

    <section id="support">
      <h2>üí¨ Need Help?</h2>
      <p>We‚Äôre here for you. Reach out to our support team anytime:</p>
      <p>
        <a href="https://wa.me/YOUR_SUPPORT_NUMBER" target="_blank" class="button">Chat on WhatsApp</a>
      </p>
    </section>
  </main>

  <footer>
    &copy; <span id="year"></span> Thrivoy. All rights reserved.
  </footer>

  <script>
  // === CONFIG ===
  const CONFIG = {
    APPS_SCRIPT_URL: "https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec", // üëâ replace
    SUPPORT_NUMBER: "917892159170" // üëâ replace with THRIVOY_SUPPORT_NUMBER
  };

  // === Utility ===
  function getQueryParam(name) {
    const params = new URLSearchParams(window.location.search);
    return params.get(name);
  }

  async function loadThankYou() {
    const bizId = getQueryParam("businessId") || getQueryParam("id") || getQueryParam("biz");
    const statusEl = document.getElementById("thankyouStatus");
    const bizEl = document.getElementById("businessInfo");
    const invoiceEl = document.getElementById("invoiceInfo");

    if (!bizId) {
      statusEl.innerHTML = "‚ùå No Business ID provided.";
      return;
    }

    try {
      const url = `${CONFIG.APPS_SCRIPT_URL}?action=getThankYou&businessId=${encodeURIComponent(bizId)}`;
      const resp = await fetch(url);
      const data = await resp.json();

      if (!data.success) {
        statusEl.innerHTML = "‚ùå Error: " + (data.error || "Unknown problem");
        return;
      }

      // Business section
      statusEl.innerHTML = "üéâ Your business website is ready!";
      bizEl.innerHTML = `
        <h2>üåê Business Details</h2>
        <p><strong>Business:</strong> ${data.business.businessName || "(not set)"}</p>
        <p><strong>Owner:</strong> ${data.business.ownerName || "(not set)"}</p>
        <p><strong>Email:</strong> ${data.business.email || "(not set)"}</p>
        ${data.websiteUrl ? `<p><a href="${data.websiteUrl}" target="_blank" class="button">View Your Website</a></p>` : ""}
      `;

      // Invoice section
      if (data.invoice && data.invoice.invoiceId) {
        invoiceEl.innerHTML = `
          <h2>üí≥ Payment Details</h2>
          <p><strong>Invoice ID:</strong> ${data.invoice.invoiceId}</p>
          ${data.invoice.upiDeepLink ? `<p><a href="${data.invoice.upiDeepLink}" target="_blank" class="button">Pay via UPI</a></p>` : ""}
          ${data.invoice.qrCodeUrl ? `<p><img src="${data.invoice.qrCodeUrl}" alt="UPI QR Code"></p>` : ""}
        `;
      } else {
        invoiceEl.innerHTML = `
          <h2>üí≥ Payment Details</h2>
          <p>‚ÑπÔ∏è No invoice found yet. If you chose a paid plan, you‚Äôll get one shortly by email.</p>
        `;
      }

      // Update WhatsApp support button
      document.querySelector("#support a").href = "https://wa.me/" + CONFIG.SUPPORT_NUMBER;

    } catch (err) {
      statusEl.innerHTML = "‚ùå Failed to load data: " + err.message;
    }
  }

  document.getElementById("year").textContent = new Date().getFullYear();
  document.addEventListener("DOMContentLoaded", loadThankYou);
  </script>
</body>
</html>
